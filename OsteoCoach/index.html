<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ParentFit v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js for beautiful stats -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Base Theme */
        :root { --bg-dark: #0f172a; --card-bg: #1e293b; --accent: #22c55e; --text-main: #f1f5f9; --text-muted: #94a3b8; }
        body { background-color: var(--bg-dark); color: var(--text-main); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        /* Components */
        .card { background-color: var(--card-bg); border-radius: 16px; padding: 20px; border: 1px solid #334155; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); transition: transform 0.1s; }
        .card:active { transform: scale(0.99); }
        .btn { padding: 12px 20px; border-radius: 12px; font-weight: 700; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; }
        .btn-primary { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3); }
        .btn-secondary { background: #334155; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .input-dark { background: #0f172a; border: 1px solid #334155; color: white; padding: 10px; border-radius: 8px; width: 100%; text-align: center; font-size: 16px; outline: none; }
        .input-dark:focus { border-color: var(--accent); }

        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        .pulse-ring { animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite; }
        @keyframes pulse-ring { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); } }

        /* Navigation */
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); border-top: 1px solid #334155; padding: 12px 20px; display: flex; justify-content: space-around; z-index: 50; padding-bottom: max(12px, env(safe-area-inset-bottom)); }
        .nav-item { color: var(--text-muted); display: flex; flex-col; flex-direction: column; align-items: center; font-size: 10px; gap: 4px; background: none; border: none; }
        .nav-item.active { color: var(--accent); }

        /* Utility */
        .hide { display: none !important; }
        .timer-circle { width: 120px; height: 120px; border-radius: 50%; border: 4px solid #334155; display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: bold; margin: 0 auto; position: relative; }
        .timer-progress { position: absolute; top: -4px; left: -4px; width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--accent); border-right-color: transparent; border-bottom-color: transparent; transform: rotate(45deg); transition: all 1s linear; }
    </style>
</head>
<body class="pb-24">

    <!-- HEADER -->
    <div class="fixed top-0 w-full bg-slate-900/90 backdrop-blur-md border-b border-slate-800 z-50 px-5 py-4 flex justify-between items-center">
        <div class="flex items-center gap-2" onclick="goHome()">
            <div class="bg-green-600/20 p-2 rounded-lg">
                <i data-lucide="dumbbell" class="text-green-500 w-5 h-5"></i>
            </div>
            <div>
                <h1 class="text-lg font-bold italic tracking-tighter leading-none">PARENT<span class="text-green-500">FIT</span></h1>
                <p class="text-[10px] text-gray-500 font-medium">STRENGTH & RECOVERY</p>
            </div>
        </div>
        <div id="sync-status" class="flex items-center gap-2 text-xs font-mono text-gray-500 bg-slate-800/50 px-2 py-1 rounded-full border border-slate-700">
            <div class="w-2 h-2 rounded-full bg-gray-500"></div> Syncing...
        </div>
    </div>

    <!-- VIEW CONTAINER -->
    <div id="main-container" class="mt-20 px-4 max-w-md mx-auto min-h-[80vh]">
        <!-- Views injected here by JS -->
    </div>

    <!-- BOTTOM NAV -->
    <nav class="nav-bar">
        <button class="nav-item active" onclick="goHome()">
            <i data-lucide="home" class="w-6 h-6"></i>
            <span>Home</span>
        </button>
        <button class="nav-item" onclick="showStats()">
            <i data-lucide="bar-chart-2" class="w-6 h-6"></i>
            <span>Stats</span>
        </button>
        <button class="nav-item" onclick="showHistory()">
            <i data-lucide="history" class="w-6 h-6"></i>
            <span>History</span>
        </button>
        <button class="nav-item" onclick="showSettings()">
            <i data-lucide="settings" class="w-6 h-6"></i>
            <span>Data</span>
        </button>
    </nav>

    <!-- LOGIC -->
    <script>
        // --- CONFIG & STATE ---
        const STEIN_URL = "https://api.steinhq.com/v1/storages/696ecce0affba40a623d7c26/workouts";
        let state = {
            logs: [],
            currentWorkoutId: 'A',
            painLevel: 0,
            userWeight: 0,
            warmupStep: 0
        };

        const WORKOUTS = {
            'A': { name: 'Upper Power', focus: 'Strength Base', exercises: [ {n:'Bench Press', t:'Safe Load'}, {n:'Chest-Supported Row', t:'Safe Load'}, {n:'Seated Tricep Dip', t:'Safe Sub'}, {n:'Lat Pulldown', t:'Vertical'} ]},
            'B': { name: 'Lower Power', focus: 'Legs (Zero Load)', exercises: [ {n:'Leg Press', t:'Safe Load'}, {n:'Lying Leg Curl', t:'Hips Down'}, {n:'Leg Extension', t:'2s Pause'}, {n:'Calf Raise', t:'Volume'} ]},
            'C': { name: 'Upper Hypertrophy', focus: 'Muscle Growth', exercises: [ {n:'Incline DB Press', t:'Head Back'}, {n:'Machine Row', t:'Stretch'}, {n:'Seated Lateral Raise', t:'3s Neg'}, {n:'Machine Pec Fly', t:'Squeeze'}, {n:'Incline Bicep Curl', t:'Stretch'} ]},
            'D': { name: 'Lower Hypertrophy', focus: 'Isolation', exercises: [ {n:'Leg Press (Low/Close)', t:'Quads'}, {n:'Single Leg Extension', t:'Balance'}, {n:'Lying Leg Curl', t:'Slow'}, {n:'Glute Bridge', t:'Floor'}, {n:'Dead Bug', t:'Core'} ]}
        };

        const WARMUP_STEPS = [
            { name: "Bird-Dog", duration: 10, cue: "Reach for walls. Fist tight. Push heel back.", icon: "dog" },
            { name: "Side Plank (L)", duration: 10, cue: "Knees bent. Hips forward. Straight line.", icon: "activity" },
            { name: "Side Plank (R)", duration: 10, cue: "Switch sides. Squeeze glutes.", icon: "activity" },
            { name: "McGill Curl-Up", duration: 10, cue: "Hands under back. Lift head 1 inch. Hold.", icon: "shield" }
        ];

        // --- INIT ---
        async function init() {
            lucide.createIcons();
            await syncData();
            goHome();
        }

        // --- SYNC ENGINE ---
        async function syncData() {
            const status = document.getElementById('sync-status');
            try {
                // Fetch from Cloud
                const res = await fetch(STEIN_URL);
                const cloudData = await res.json();
                
                // Merge with Local (Simple merge: Cloud wins if collision, but we append local unsynced)
                // For simplicity in this v4 demo, we treat Cloud as Truth + Local Backup
                const validCloud = Array.isArray(cloudData) ? cloudData.filter(d => d.date) : [];
                state.logs = validCloud;
                
                // Save Backup
                localStorage.setItem('pf_backup', JSON.stringify(state.logs));
                
                status.innerHTML = `<div class="w-2 h-2 rounded-full bg-green-500"></div> Connected`;
                status.classList.remove('text-gray-500'); status.classList.add('text-green-500');
            } catch (e) {
                console.error(e);
                const local = localStorage.getItem('pf_backup');
                if(local) state.logs = JSON.parse(local);
                status.innerHTML = `<div class="w-2 h-2 rounded-full bg-yellow-500"></div> Offline`;
            }
            determineNextWorkout();
        }

        function determineNextWorkout() {
            if(!state.logs.length) return;
            const sorted = [...state.logs].sort((a,b) => new Date(b.date) - new Date(a.date));
            const lastId = sorted[0].workoutId;
            const order = ['A','B','C','D'];
            const nextIdx = (order.indexOf(lastId) + 1) % 4;
            state.currentWorkoutId = order[nextIdx];
        }

        // --- NAVIGATION ---
        function goHome() {
            setActiveNav(0);
            const wId = state.currentWorkoutId;
            const wName = WORKOUTS[wId].name;
            
            render(`
                <div class="fade-in pt-4">
                    <div class="mb-8 text-center">
                        <span class="text-xs font-bold text-green-500 uppercase tracking-widest mb-1 block">Welcome Back</span>
                        <h2 class="text-3xl font-black text-white mb-2">Ready to Train?</h2>
                        <p class="text-slate-400 text-sm">Next up: <span class="text-white font-bold">Workout ${wId} (${wName})</span></p>
                    </div>

                    <div class="card mb-6 bg-gradient-to-br from-slate-800 to-slate-900 border-green-900/30">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                            <i data-lucide="shield-alert" class="text-green-500"></i> Pain Check-In
                        </h3>
                        <p class="text-sm text-slate-400 mb-6">Before we unlock the weights, how is the spine feeling today?</p>
                        <div class="grid grid-cols-5 gap-2">
                            ${[1,2,3,4,5,6,7,8,9,10].map(n => `
                                <button onclick="handlePain(${n})" class="h-12 rounded-lg font-bold border ${n<=3 ? 'border-green-600 bg-green-900/20 hover:bg-green-600' : n<=7 ? 'border-yellow-600 bg-yellow-900/20 hover:bg-yellow-600' : 'border-red-600 bg-red-900/20 hover:bg-red-600'} transition-colors">${n}</button>
                            `).join('')}
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="startWarmupMode()" class="card flex flex-col items-center justify-center gap-3 hover:bg-slate-800 transition">
                            <div class="bg-blue-500/20 p-3 rounded-full"><i data-lucide="timer" class="text-blue-400"></i></div>
                            <span class="font-bold text-sm">Warmup Guide</span>
                        </button>
                        <button onclick="showStats()" class="card flex flex-col items-center justify-center gap-3 hover:bg-slate-800 transition">
                            <div class="bg-purple-500/20 p-3 rounded-full"><i data-lucide="trending-up" class="text-purple-400"></i></div>
                            <span class="font-bold text-sm">View Stats</span>
                        </button>
                    </div>
                </div>
            `);
        }

        // --- PAIN LOGIC ---
        function handlePain(level) {
            state.painLevel = level;
            if (level <= 3) {
                renderWorkoutView(state.currentWorkoutId);
            } else if (level <= 7) {
                renderYellowZone();
            } else {
                renderRedZone();
            }
        }

        // --- WARMUP WIZARD ---
        function startWarmupMode() {
            state.warmupStep = 0;
            renderWarmupStep();
        }

        function renderWarmupStep() {
            const step = WARMUP_STEPS[state.warmupStep];
            if(!step) {
                goHome();
                return;
            }

            render(`
                <div class="fade-in pt-8 text-center h-full flex flex-col justify-between">
                    <div>
                        <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-800 text-slate-400 mb-6 font-mono text-sm border border-slate-700">
                            ${state.warmupStep + 1}/${WARMUP_STEPS.length}
                        </div>
                        <h2 class="text-3xl font-bold mb-2 text-white">${step.name}</h2>
                        <p class="text-green-400 font-medium mb-8 text-lg">${step.cue}</p>
                        
                        <div class="timer-circle mb-8">
                            <div id="timer-display">${step.duration}</div>
                        </div>
                    </div>

                    <div class="mt-auto">
                        <button id="start-timer-btn" onclick="runTimer(${step.duration})" class="btn btn-primary mb-4 py-4 text-lg">
                            <i data-lucide="play"></i> Start Timer
                        </button>
                        <button onclick="goHome()" class="text-slate-500 text-sm">Exit Warmup</button>
                    </div>
                </div>
            `);
        }

        function runTimer(seconds) {
            const display = document.getElementById('timer-display');
            const btn = document.getElementById('start-timer-btn');
            btn.classList.add('hide'); // Hide button
            document.querySelector('.timer-circle').classList.add('pulse-ring', 'border-green-500'); // Add pulse effect

            let left = seconds;
            const interval = setInterval(() => {
                left--;
                display.innerText = left;
                if(left <= 0) {
                    clearInterval(interval);
                    document.querySelector('.timer-circle').classList.remove('pulse-ring', 'border-green-500');
                    nextWarmupStep();
                }
            }, 1000);
        }

        function nextWarmupStep() {
            state.warmupStep++;
            if(state.warmupStep >= WARMUP_STEPS.length) {
                alert("Warmup Complete! Core is stiff.");
                renderWorkoutView(state.currentWorkoutId);
            } else {
                renderWarmupStep();
            }
        }

        // --- WORKOUT LOGGER ---
        function renderWorkoutView(wId) {
            const w = WORKOUTS[wId];
            let html = `
                <div class="fade-in pt-4 pb-24">
                    <div class="flex justify-between items-end mb-6">
                        <div>
                            <span class="text-xs font-bold text-green-500">WORKOUT ${wId}</span>
                            <h2 class="text-3xl font-black italic">${w.name}</h2>
                        </div>
                    </div>
            `;
            
            w.exercises.forEach((ex, idx) => {
                const pb = getPB(ex.name);
                html += `
                <div class="card mb-4 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                        <i data-lucide="dumbbell" class="w-24 h-24"></i>
                    </div>
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-lg">${ex.name}</h3>
                                <span class="text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded bg-slate-800 text-slate-300 border border-slate-700">${ex.t}</span>
                            </div>
                            <div class="text-right">
                                <div class="text-[10px] text-slate-500 uppercase font-bold">Best e1RM</div>
                                <div class="font-mono font-bold text-green-400">${pb}kg</div>
                            </div>
                        </div>
                        
                        <div class="flex gap-3 items-end">
                            <div class="flex-1">
                                <label class="text-[10px] text-slate-400 font-bold mb-1 block pl-1">WEIGHT</label>
                                <input type="number" id="w-${idx}" class="input-dark" placeholder="kg" oninput="calcGhost(${idx})">
                            </div>
                            <div class="flex-1">
                                <label class="text-[10px] text-slate-400 font-bold mb-1 block pl-1">REPS</label>
                                <input type="number" id="r-${idx}" class="input-dark" placeholder="reps" oninput="calcGhost(${idx})">
                            </div>
                            <div class="w-16 text-center">
                                <div class="text-[10px] text-slate-500 font-bold mb-2">GHOST</div>
                                <div id="g-${idx}" class="font-mono text-sm text-slate-300">0</div>
                            </div>
                        </div>

                        <button onclick="logSet('${wId}', '${ex.name}', ${idx}, this)" class="btn btn-secondary mt-4 w-full">
                            <i data-lucide="save" class="w-4 h-4"></i> Log Set
                        </button>
                    </div>
                </div>`;
            });

            html += `
                <button onclick="finishSession()" class="btn btn-primary py-4 text-lg shadow-lg shadow-green-900/50 mt-8">
                    Finish Workout
                </button>
            </div>`;
            render(html);
        }

        async function logSet(wId, exName, idx, btn) {
            const w = document.getElementById(`w-${idx}`).value;
            const r = document.getElementById(`r-${idx}`).value;
            if(!w || !r) return;
            
            const oldText = btn.innerHTML;
            btn.innerHTML = `<span class="animate-spin">⏳</span> Saving...`;
            
            const e1rm = (w * (1 + r/30)).toFixed(1);
            const entry = { date: new Date().toISOString().split('T')[0], workoutId: wId, exercise: exName, weight: w, reps: r, e1rm: e1rm };
            
            // Optimistic save
            state.logs.push(entry);
            localStorage.setItem('pf_backup', JSON.stringify(state.logs));
            
            // API Push
            try {
                await fetch(STEIN_URL, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify([entry]) });
                btn.innerHTML = `<i data-lucide="check"></i> Saved`;
                btn.classList.replace('btn-secondary', 'btn-primary');
            } catch(e) {
                btn.innerHTML = `<i data-lucide="alert-circle"></i> Local Only`;
            }
            setTimeout(() => { btn.innerHTML = oldText; btn.classList.replace('btn-primary', 'btn-secondary'); }, 2000);
        }

        // --- STATS VIEW ---
        function showStats() {
            setActiveNav(1);
            
            // Process Data for Chart (Bench Press Progress)
            const benchLogs = state.logs.filter(l => l.exercise.includes('Bench') || l.exercise.includes('Press'));
            const dates = benchLogs.map(l => l.date.slice(5)); // MM-DD
            const dataPoints = benchLogs.map(l => l.e1rm);

            render(`
                <div class="fade-in pt-4">
                    <h2 class="text-2xl font-bold mb-6">Performance Stats</h2>
                    
                    <div class="card mb-6">
                        <h3 class="font-bold text-sm text-slate-400 mb-4">Strength Trend (Pushing)</h3>
                        <canvas id="strengthChart" height="200"></canvas>
                    </div>

                    <div class="card">
                        <h3 class="font-bold text-sm text-slate-400 mb-4">Total Workouts</h3>
                        <div class="text-4xl font-black text-white">${state.logs.length} <span class="text-sm font-normal text-slate-500">sessions</span></div>
                    </div>
                </div>
            `);

            if(benchLogs.length > 0) {
                new Chart(document.getElementById('strengthChart'), {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [{
                            label: 'e1RM (kg)',
                            data: dataPoints,
                            borderColor: '#22c55e',
                            tension: 0.4,
                            pointBackgroundColor: '#fff'
                        }]
                    },
                    options: { 
                        plugins: { legend: {display: false} }, 
                        scales: { y: { grid: {color: '#334155'} }, x: { grid: {display: false} } } 
                    }
                });
            } else {
                document.getElementById('strengthChart').parentNode.innerHTML = "<p class='text-slate-500 text-center py-8'>Log more workouts to see charts!</p>";
            }
        }

        // --- HISTORY & DATA VIEW ---
        function showHistory() {
            setActiveNav(2);
            let html = `<div class="fade-in pt-4"><h2 class="text-2xl font-bold mb-6">Workout History</h2>`;
            [...state.logs].reverse().forEach(log => {
                html += `
                    <div class="card mb-2 py-3 px-4 flex justify-between items-center">
                        <div>
                            <div class="text-[10px] text-slate-500 font-bold">${log.date} • ${log.workoutId}</div>
                            <div class="font-bold text-sm">${log.exercise}</div>
                        </div>
                        <div class="text-right">
                            <div class="text-green-400 font-mono font-bold">${log.weight}kg x ${log.reps}</div>
                            <div class="text-[10px] text-slate-600">e1RM: ${log.e1rm}</div>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
            render(html);
        }

        function showSettings() {
            setActiveNav(3);
            render(`
                <div class="fade-in pt-4">
                    <h2 class="text-2xl font-bold mb-6">Data Management</h2>
                    
                    <div class="card mb-6">
                        <h3 class="font-bold mb-2">Cloud Sync</h3>
                        <p class="text-xs text-slate-400 mb-4">Connected to SteinHQ/Google Sheets.</p>
                        <div class="flex items-center gap-2 text-green-500 text-sm font-mono">
                            <i data-lucide="check-circle" class="w-4 h-4"></i> Active
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="font-bold mb-4">Local Backup (CSV)</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="exportCSV()" class="btn btn-secondary text-sm">
                                <i data-lucide="download"></i> Export CSV
                            </button>
                            <label class="btn btn-secondary text-sm cursor-pointer">
                                <i data-lucide="upload"></i> Import CSV
                                <input type="file" id="csvImport" class="hidden" accept=".csv" onchange="importCSV(this)">
                            </label>
                        </div>
                        <p class="text-xs text-slate-500 mt-4">Importing will merge new unique records into your app.</p>
                    </div>
                </div>
            `);
        }

        // --- UTILS ---
        function render(html) {
            document.getElementById('main-container').innerHTML = html;
            lucide.createIcons();
        }
        
        function setActiveNav(idx) {
            document.querySelectorAll('.nav-item').forEach((el, i) => {
                if(i === idx) el.classList.add('active'); else el.classList.remove('active');
            });
        }

        function calcGhost(idx) {
            const w = document.getElementById(`w-${idx}`).value;
            const r = document.getElementById(`r-${idx}`).value;
            const el = document.getElementById(`g-${idx}`);
            if(w && r) el.innerText = (w * (1 + r/30)).toFixed(1);
            else el.innerText = '0';
        }

        function getPB(name) {
            const matches = state.logs.filter(l => l.exercise === name);
            if(!matches.length) return 0;
            return Math.max(...matches.map(l => parseFloat(l.e1rm) || 0));
        }

        // --- CSV LOGIC ---
        function exportCSV() {
            let csv = "date,workoutId,exercise,weight,reps,e1rm\n";
            state.logs.forEach(l => { csv += `${l.date},${l.workoutId},${l.exercise},${l.weight},${l.reps},${l.e1rm}\n` });
            const blob = new Blob([csv], {type:'text/csv'});
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'parentfit_backup.csv'; a.click();
        }

        function importCSV(input) {
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const rows = e.target.result.split('\n').slice(1);
                let count = 0;
                rows.forEach(row => {
                    const [d, wid, ex, w, r, e1] = row.split(',');
                    if(d && ex) {
                        const exists = state.logs.some(l => l.date === d && l.exercise === ex && l.weight == w && l.reps == r);
                        if(!exists) {
                            state.logs.push({date:d, workoutId:wid, exercise:ex, weight:w, reps:r, e1rm:e1});
                            count++;
                        }
                    }
                });
                localStorage.setItem('pf_backup', JSON.stringify(state.logs));
                alert(`Imported ${count} new records.`);
                location.reload();
            };
            reader.readAsText(file);
        }

        // --- RECOVERY ZONES ---
        function renderYellowZone() {
             render(`
                <div class="fade-in pt-8 text-center">
                    <div class="bg-yellow-500/10 border border-yellow-500/50 rounded-2xl p-8 mb-8 inline-block">
                        <i data-lucide="alert-triangle" class="w-16 h-16 text-yellow-500 mx-auto mb-4"></i>
                        <h2 class="text-2xl font-bold text-yellow-500">Active Recovery</h2>
                        <p class="text-yellow-200/60 mt-2">Zone Yellow (Pain 4-7)</p>
                    </div>
                    <div class="text-left space-y-4">
                        <div class="card border-l-4 border-yellow-500">
                            <h3 class="font-bold text-lg">1. Flush Walk</h3>
                            <p class="text-slate-400 text-sm">10-15 mins brisk walking. Swing arms.</p>
                        </div>
                        <div class="card border-l-4 border-yellow-500">
                            <h3 class="font-bold text-lg">2. McGill Big 3</h3>
                            <p class="text-slate-400 text-sm">Perform the circuit twice. Focus on stiffness.</p>
                        </div>
                    </div>
                    <button onclick="goHome()" class="mt-8 text-slate-500 underline">Back to Menu</button>
                </div>
            `);
        }

        function renderRedZone() {
             render(`
                <div class="fade-in pt-8 text-center">
                    <div class="bg-red-500/10 border border-red-500/50 rounded-2xl p-8 mb-8 inline-block">
                        <i data-lucide="x-octagon" class="w-16 h-16 text-red-500 mx-auto mb-4"></i>
                        <h2 class="text-2xl font-bold text-red-500">STOP TRAINING</h2>
                        <p class="text-red-200/60 mt-2">Zone Red (Pain 8+)</p>
                    </div>
                    <div class="card bg-red-900/20 border-red-900 text-left">
                        <h3 class="font-bold text-red-400 mb-2">Emergency Protocol</h3>
                        <ul class="list-disc pl-5 text-sm text-slate-400 space-y-2">
                            <li>Lie on stomach (Prone Prop) for 2 mins.</li>
                            <li>No heavy lifting or bending.</li>
                            <li>Apply heat if muscle is spasming.</li>
                        </ul>
                    </div>
                    <button onclick="goHome()" class="mt-8 text-slate-500 underline">Back to Menu</button>
                </div>
            `);
        }

        function finishSession() {
            if(confirm("Finish session and save progress?")) {
                location.reload();
            }
        }

        // Start App
        init();
    </script>
</body>
</html>